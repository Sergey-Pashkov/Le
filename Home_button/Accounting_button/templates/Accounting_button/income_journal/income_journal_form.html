{% extends "Accounting_button/base.html" %}
{% load form_tags %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">{% if journal %}Редактировать{% else %}Создать{% endif %} запись</h2>

    <form method="post" id="income-journal-form">
        {% csrf_token %}
        <div class="form-group">
            <label for="id_name">Название</label>
            {{ form.name|add_class:"form-control" }}
        </div>
        <div class="form-group">
            <label for="id_value">Сумма</label>
            {{ form.value|add_class:"form-control" }}
        </div>
        <div class="form-group" id="client-group">
            <label for="id_client">Клиент</label>
            {{ form.client|add_class:"form-control" }}
        </div>
        <div class="form-group">
            <label for="id_date_of_event">Дата события</label>
            {{ form.date_of_event|add_class:"form-control" }}
        </div>
        <div class="form-group">
            <label for="id_comment">Комментарий</label>
            {{ form.comment|add_class:"form-control" }}
        </div>
        <button type="submit" class="btn btn-primary">Сохранить</button>
        <a href="{% url 'Accounting_button:income_journal_list' %}" class="btn btn-secondary ml-2">Отмена</a>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const nameField = document.getElementById('id_name');
        const clientField = document.getElementById('id_client');
        const clientGroup = document.getElementById('client-group');

        function toggleClientField() {
            if (nameField.value === 'Займы') {
                clientField.value = '';  // Очистка значения поля client
                clientField.disabled = true;  // Отключаем поле client
                clientGroup.style.display = 'none';  // Скрываем группу полей client
            } else {
                clientField.disabled = false;  // Включаем поле client
                clientGroup.style.display = 'block';  // Показываем группу полей client
            }
        }

        // Включаем/выключаем поле при загрузке страницы
        toggleClientField();

        // Добавляем обработчик события на изменение поля name
        nameField.addEventListener('change', toggleClientField);
    });
</script>
{% endblock %}
